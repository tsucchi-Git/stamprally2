<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet' href='css/menu.css'/>
  <title>Document</title>
</head>
<style>
  .page-title{
    margin-top:8%;
    text-align: center;
  }
  table{
    width:100%;
    table-layout:fixed;
    margin-top: 10px;
  }
  .table-img{
    text-align: center; /* 横方向の中央揃え */
    vertical-align: middle; /* 縦方向の中央揃え */
  }
  .table-img-detail{
    text-align: center; /* 横方向の中央揃え */
    vertical-align: middle; /* 縦方向の中央揃え */
    cursor: pointer; /* オーバーハング時にカーソルを表示する */
  }
  .table-text{
    text-align: left; /* 横方向の中央揃え */
    vertical-align: middle; /* 縦方向の中央揃え */
    font-size: 75%;
    white-space:nowrap;
    width:100%
  }
  .table-text2{
    text-align: center; /* 横方向の中央揃え */
    vertical-align: middle; /* 縦方向の中央揃え */
    font-size: 85%;
    white-space:nowrap;
    width:100%
  }

 </style>
 <body>
  <nav>
    <ul>
    <li class=”current”><a href='index.html'>ホーム</a></li>
    <li><a href='stampnote.html'>スタンプ帳</a></li>
    <li><a href='howtoplay.html'>遊び方</a></li>
    <!-- <li><a href=”#”>Blog</a></li> -->
    </ul>
   </nav>
  <div class="page-title">スポットリスト</div>
  <table border="1" >
    <tbody>
      <!-- 1スポット目 -->
      <tr>
          <td rowspan="5" width="30%"><img id="image1" width="100%" class="table-img"></td>
        </tr>
        <tr>
          <td colspan="5" id="title1"  class="table-text"></td>
          <td id="number1" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address1"  class="table-text"></td>
          <td id="get_yn1" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address_detail1" class="table-text"></td>
          <td rowspan="2"><img id="go_detail1" width="100%" class="table-img-detail"></td>
        </tr>
        <tr>
          <td colspan="5" id="era1" class="table-text"></td>
        </tr>
        <!-- 2スポット目 -->
        <tr>
          <td rowspan="5" width="30%"><img id="image2" width="100%" class="table-img"></td>
        </tr>
        <tr>
          <td colspan="5" id="title2"  class="table-text"></td>
          <td id="number2" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address2"  class="table-text"></td>
          <td id="get_yn2" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address_detail2" class="table-text"></td>
          <td rowspan="2"><img id="go_detail2" width="100%" class="table-img-detail"></td>
        </tr>
        <tr>
          <td colspan="5" id="era2" class="table-text"></td>
        </tr>
        <!-- 3スポット目 -->
        <tr>
          <td rowspan="5" width="30%"><img id="image3" width="100%" class="table-img"></td>
        </tr>
        <tr>
          <td colspan="5" id="title3"  class="table-text"></td>
          <td id="number3" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address3"  class="table-text"></td>
          <td id="get_yn3" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address_detail3" class="table-text"></td>
          <td rowspan="2"><img id="go_detail3" width="100%" class="table-img-detail"></td>
        </tr>
        <tr>
          <td colspan="5" id="era3" class="table-text"></td>
        </tr>
        <!-- 4スポット目 -->
        <tr>
          <td rowspan="5" width="30%"><img id="image4" width="100%" class="table-img"></td>
        </tr>
        <tr>
          <td colspan="5" id="title4"  class="table-text"></td>
          <td id="number4" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address4"  class="table-text"></td>
          <td id="get_yn4" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address_detail4" class="table-text"></td>
          <td rowspan="2"><img id="go_detail4" width="100%" class="table-img-detail"></td>
        </tr>
        <tr>
          <td colspan="5" id="era4" class="table-text"></td>
        </tr>
        <!-- 5スポット目 -->
        <tr>
          <td rowspan="5" width="30%"><img id="image5" width="100%" class="table-img"></td>
        </tr>
        <tr>
          <td colspan="5" id="title5"  class="table-text"></td>
          <td id="number5" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address5"  class="table-text"></td>
          <td id="get_yn5" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address_detail5" class="table-text"></td>
          <td rowspan="2"><img id="go_detail5" width="100%" class="table-img-detail"></td>
        </tr>
        <tr>
          <td colspan="5" id="era5" class="table-text"></td>
        </tr>
        <!-- 6スポット目 -->
        <tr>
          <td rowspan="5" width="30%"><img id="image6" width="100%" class="table-img"></td>
        </tr>
        <tr>
          <td colspan="5" id="title6"  class="table-text"></td>
          <td id="number6" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address6"  class="table-text"></td>
          <td id="get_yn6" class="table-text2"></td>
        </tr>
        <tr>
          <td colspan="5" id="address_detail6" class="table-text"></td>
          <td rowspan="2"><img id="go_detail6" width="100%" class="table-img-detail"></td>
        </tr>
        <tr>
          <td colspan="5" id="era6" class="table-text"></td>
        </tr>
      </tbody>
  </table>
   
  <script>

      if(window.localStorage){
          //ローカルストレージの基礎データを取得→配列名arrayに格納、キーは「all_basic_data」
          let json=localStorage.getItem('all_basic_data');
          let array=JSON.parse(json);
           //ローカルストレージからキー「vsit_data」で基礎データを読み込み配列visit_ynに格納
          let json_visit=localStorage.getItem('visit_data');
          visit_yn=JSON.parse(json_visit); //[-1,-1,-1,-1,-1,-1]
          //関数spotshowの呼び出し
          spot_show(array,visit_yn);
        }
      else{
        alert('ローカルストレージは使えません');
      }
      //スポット一覧を表示する
      function spot_show(array,visit_yn){
        //すべてのスポットの「名称」と「訪問の有無」をローカルストレージに保存（キーは「get-yesno」）→スタンプ帳用
            let spot_array_all=[array[0][2],array[0][11]];
            for(let i=1 ;i<array.length ;i++){
            spot_array_all.push(array[i][2]);spot_array_all.push(array[i][11])
        }
        //各スポットが訪問済みか否かのデータをローカルストレージから読み込む
        if(window.localStorage){
              let json_string=JSON.stringify(spot_array_all);   //配列をJSONデータに返還し、json_stringという変数に一括代入
              localStorage.setItem('get-yesno',json_string)
            }
            else
            {
              alert('ローカルストレージは使えません');
            }
        //ウェブページへの書き出し  
        for(let i=0 ;i<array.length ;i++){
          let s_number=array[i][1];
          let s_yesno_temp=visit_yn[i];
          if(s_yesno_temp<0){
            s_yesno='未'
          }else{
            s_yesno='済'
          }
          let s_img=array[i][8];
          let s_title=array[i][2];
          let s_address=array[i][6];
          let s_address_detail=array[i][7];
          let s_era=array[i][5];
          // if(i==array.length-1){
          //   alert(s_number,s_yesno,s_img,s_title)
          // }
          var i1=i+1
          var e_number=document.getElementById("number" +i1);e_number.textContent=s_number ;//スポット番号を更新      
          var e_yesno=document.getElementById("get_yn" +i1);e_yesno.textContent=s_yesno ;//スポット番号を更新
          var e_img=document.getElementById("image" +i1);e_img.src='image/' + s_img ;//画像ファイルを更新
          var e_title=document.getElementById("title" +i1);e_title.textContent="名称：" + s_title ; //名称の更新
          var e_address=document.getElementById("address" +i1);e_address.textContent="住所：" + s_address ; //住所の更新
          var e_address_detail=document.getElementById("address_detail" +i1);e_address_detail.textContent="場所の詳細：" + s_address_detail ; //場所の詳細の更新  
          var e_era=document.getElementById("era" +i1);e_era.textContent="年代：" + s_era  ;//年代を更新
          var e_detail=document.getElementById("go_detail" +i1);e_detail.src="icon/detail_icon.png" ; //詳細説明のページに遷移
          //「詳細？」にクリックイベントを付加
          const button_detail=document.getElementById("go_detail" +i1);
          //スポットの画像または「詳細？」がクリックされたときに詳細ページに遷移
          e_img.addEventListener('click', function(){spot_jamp_detail(i)});
          button_detail.addEventListener('click', function(){spot_jamp_detail(i)});
        function spot_jamp_detail(i){
            let s_explanation=array[i][9];//スポットに関する説明を変数に代入
            let spot_array=[s_title,s_img,s_address,s_address_detail,s_era,s_explanation,s_yesno];//詳細ボタンがクリックされたときに、当該スポットのデータの一部を配列に格納
            //ローカルストレージに「spot-selected」のキーで選択されたスポットのデータ配列を保存
            if(window.localStorage){
              //配列をJSONデータに返還し、json_stringという変数に一括代入
              let json_string=JSON.stringify(spot_array);   
              localStorage.setItem('selected-spot',json_string)
            }
            else
            {
              alert('ローカルストレージは使えません');
            }
            //詳細のページに遷移
            window.location.href ='detail.html'} ;
        }
      }
  </script>
</body>
</html>